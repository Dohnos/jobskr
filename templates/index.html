<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jobs.cz Scraper ‚Äì e‚Äëshop nab√≠dky</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: #f6f8fa;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        .container {
            max-width: 480px;
            margin: 48px auto;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.08);
            padding: 32px 24px 24px 24px;
        }
        h1 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 8px;
        }
        .emoji {
            font-size: 2.2rem;
            vertical-align: middle;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 24px;
        }
        input[type="text"] {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: 1rem;
        }
        button {
            background: #0072c6;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 12px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover {
            background: #005fa3;
        }
        .result {
            margin-top: 32px;
            text-align: center;
        }
        .loader {
            margin: 32px auto;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #0072c6;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .footer {
            text-align: center;
            color: #888;
            font-size: 0.95rem;
            margin-top: 48px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">üõí</span> Jobs.cz e‚Äëshop nab√≠dky</h1>
        <form id="searchForm">
            <label for="keyword">Kl√≠ƒçov√© slovo <span class="emoji">üîé</span></label>
            <input type="text" id="keyword" name="keyword" placeholder="nap≈ô. e‚Äëshop, ecommerce, online marketing" required>
            <button type="submit">Vygenerovat PDF <span class="emoji">üìÑ</span></button>
        </form>
        <div class="result" id="result"></div>
    </div>
    <div class="footer">
        <span class="emoji">üí°</span> Vyhled√°v√°n√≠ a PDF generuje backend (Flask).<br>
        <span class="emoji">‚úâÔ∏è</span> Mo≈ænost zaslat PDF e‚Äëmailem:<br>
        <form id="emailForm" style="margin-top:12px;display:flex;gap:8px;justify-content:center;align-items:center;flex-wrap:wrap;">
            <input type="email" id="email" name="email" placeholder="V√°≈° e‚Äëmail" required style="padding:8px;border-radius:6px;border:1px solid #d1d5db;min-width:180px;">
            <button type="submit" style="padding:8px 16px;font-size:1rem;">Odeslat PDF <span class="emoji">‚úâÔ∏è</span></button>
        </form>
        <div id="emailResult" style="margin-top:8px;"></div>
    </div>
    <script>
        const form = document.getElementById('searchForm');
        const resultDiv = document.getElementById('result');
        let lastKeyword = '';
        let lastPdfBlob = null;
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            resultDiv.innerHTML = '<div class="loader"></div><div>Generuji PDF, ƒçekejte‚Ä¶</div>';
            const keyword = document.getElementById('keyword').value;
            lastKeyword = keyword;
            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ keyword })
                });
                if (!response.ok) throw new Error('Chyba p≈ôi generov√°n√≠ PDF.');
                const blob = await response.blob();
                lastPdfBlob = blob;
                const url = window.URL.createObjectURL(blob);
                resultDiv.innerHTML = `<a href="${url}" download="jobs.pdf" style="font-size:1.2rem;font-weight:bold;">St√°hnout PDF <span class='emoji'>‚¨áÔ∏è</span></a>`;
            } catch (err) {
                resultDiv.innerHTML = `<span style='color:#c00;'>${err.message}</span>`;
            }
        });
        // Odesl√°n√≠ PDF e-mailem
        const emailForm = document.getElementById('emailForm');
        const emailResult = document.getElementById('emailResult');
        emailForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            emailResult.innerHTML = '<span class="loader" style="width:24px;height:24px;border-width:4px;"></span> Odes√≠l√°m‚Ä¶';
            const email = document.getElementById('email').value;
            if (!lastKeyword) {
                emailResult.innerHTML = '<span style="color:#c00;">Nejprve vygenerujte PDF.</span>';
                return;
            }
            try {
                const response = await fetch('/send_email', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ keyword: lastKeyword, email })
                });
                if (!response.ok) throw new Error('Chyba p≈ôi odes√≠l√°n√≠ e‚Äëmailu.');
                const data = await response.json();
                emailResult.innerHTML = `<span style='color:green;'>${data.message}</span>`;
            } catch (err) {
                emailResult.innerHTML = `<span style='color:#c00;'>${err.message}</span>`;
            }
        });
    </script>
</body>
</html>
<!--
====================
Instrukce k nasazen√≠:
====================

1. Backend (Flask) ‚Äì Render.com:
--------------------------------
- V ko≈ôenov√©m adres√°≈ôi projektu mus√≠ b√Ωt soubory: app.py, scrape.py, DejaVuSans.ttf, DejaVuSans-Bold.ttf, jobs.pdf, slo≈æka templates/ s index.html.
- Vytvo≈ôte requirements.txt s bal√≠ƒçky: flask, requests, beautifulsoup4, reportlab, (p≈ô√≠padnƒõ dal≈°√≠ dle k√≥du), a knihovny pro e-mail (nap≈ô. smtplib, email).
- V app.py mus√≠ b√Ωt endpointy:
    - / (GET): renderuje index.html
    - /generate (POST): p≈ôij√≠m√° {keyword}, vrac√≠ PDF (application/pdf)
    - /send_email (POST): p≈ôij√≠m√° {keyword, email}, vygeneruje PDF a ode≈°le na e-mail (vrac√≠ JSON s v√Ωsledkem)
- Nastavte promƒõnn√© prost≈ôed√≠ pro SMTP (nap≈ô. SMTP_SERVER, SMTP_PORT, SMTP_USER, SMTP_PASSWORD) v Render.com dashboardu.
- Nastavte startovac√≠ p≈ô√≠kaz: python app.py

2. Frontend (GitHub Pages):
---------------------------
- Pokud chcete frontend oddƒõlenƒõ, staƒç√≠ zkop√≠rovat index.html (a p≈ô√≠padnƒõ styly/js) do repozit√°≈ôe pro GitHub Pages.
- V≈°echny API vol√°n√≠ mus√≠ smƒõ≈ôovat na ve≈ôejnou URL backendu na Render.com (nap≈ô. https://moje-aplikace.onrender.com/generate).
- Pro lok√°ln√≠ v√Ωvoj lze pou≈æ√≠t Flask backend a ≈°ablonu v templates/.

3. Odes√≠l√°n√≠ e-mailu:
---------------------
- Backend mus√≠ implementovat endpoint /send_email, kter√Ω p≈ôijme e-mail a kl√≠ƒçov√© slovo, vygeneruje PDF a ode≈°le jej jako p≈ô√≠lohu.
- SMTP √∫daje (server, port, u≈æivatel, heslo) nastavte jako promƒõnn√© prost≈ôed√≠ (neukl√°dejte do k√≥du!).
- Pro testov√°n√≠ lze pou≈æ√≠t nap≈ô. Gmail SMTP (nutno povolit p≈ô√≠stup pro aplikace, p≈ô√≠padnƒõ pou≈æ√≠t App Password).

4. Produkƒçn√≠ tipy:
------------------
- O≈°et≈ôete limity a timeouty (scraping jobs.cz m≈Ø≈æe b√Ωt pomal√Ω).
- Omezte poƒçet str√°nek nebo nab√≠dek na jedno generov√°n√≠.
- Logujte chyby a √∫spƒõ≈°n√© odesl√°n√≠ e-mailu.
- Chra≈àte endpointy proti zneu≈æit√≠ (rate limiting, captcha, atd.).

5. Uk√°zka API vol√°n√≠ (fetch):
-----------------------------
POST /generate
{ "keyword": "e‚Äëshop" }
‚Üí application/pdf

POST /send_email
{ "keyword": "e‚Äëshop", "email": "uzivatel@email.cz" }
‚Üí { "message": "PDF bylo odesl√°no na e‚Äëmail." }

-->
